{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": { "text": "Top YouTubers by Subscribers", "fontSize" : 30},
  "data": { "url": "./data/youtube_data_cleaned.csv" },
  "height": 600,
  "width": "container",
  "autosize": {"type": "fit", "contains": "padding"},

  "params": [
    {
      "name": "CountrySelect",
      "value": "All",
      "bind": {
        "input": "select",
        "options": [
          "All",
          "United States",
          "India",
          "Brazil",
          "Mexico",
          "United Kingdom",
          "Spain",
          "Indonesia",
          "Russia"
        ],
        "name": "Select Country: "
      }
    }



  ],


    "transform": [
        {"filter": "CountrySelect == 'All' || datum.Country == CountrySelect"},
        {"calculate": "datum.Subscribers / 1000000", "as": "Subscribers_Millions"},
        {"window": [{"op": "rank", "as": "Rank"}], "sort": [{"field": "Subscribers_Millions", "order": "descending"}]},
        {"filter": "datum.Rank <= 10"} 
    ],

  "mark": {"type" : "bar", "color": "#CD201F", "opacity": 0.7},
  "encoding": {
    "x": { "field": "Subscribers", "type": "quantitative", "title": "Subscribers", "axis": {"titleFontSize": 14}},
    "y": { "field": "Name", "type": "nominal", "sort": "-x", "axis": {"labelLimit": 0, "labelFontSize": 14, "labelPadding": 30, "titleFontSize": 14}},
    "tooltip": [
      { "field": "Name", "title": "Name of Youtuber" },
      { "field": "Subscribers", "format": ",.0f"},
      { "field": "Country" }
    ]
  }
}
