{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": {"text" : "Youtuber Engagement Bubble Plot", "fontSize": 26},
  "data": {"url": "./data/youtube_data_cleaned.csv"},
  "height": 650,
  "width": "container",
  "autosize": {"type": "fit", "contains": "padding"},

  "params": [
    {
      "name": "MinSubs",
      "value": 50000000,
      "bind": {
        "input": "range",
        "min": 0,
        "max": 200000000,
        "step": 5000000,
        "name": "Minimum Subscribers: "
      }
    }
  ],

  "transform": [
        { "filter": "datum.Avg_views > 0" },
        { "filter": "datum.Avg_likes > 0" },
        { "filter": "datum.Subscribers >= MinSubs" }
      
      ],


  "layer" : [
    {"mark": {"type": "circle", "color" : "#C455A8","opacity": 0.7, "stroke": "black", "strokeWidth": 0.5},
    "encoding": {
      "x": {
        "field": "Avg_views",
        "type": "quantitative",
        "title": "Average Views",
        "scale": {"type" : "log", "domain": [100, 100000000]}
      },
      "y": {
        "field": "Avg_likes",
        "type": "quantitative",
        "title": "Average Likes",
        "scale": {"type" : "log", "domain": [1, 10000000]}
      },
      "size": {
        "field": "Subscribers",
        "type": "quantitative",
        "title": "Subscribers",
        "scale": {"range": [10, 2000]},
        "legend" : null
      },
      "opacity": {
                  "condition": {
                    "test": "datum.Subscribers > 100000000",
                    "value": 1
                  },
                  "value": 0.5},

      "tooltip": [
          {"field": "Name", "type": "nominal"},
          {"field": "Subscribers", "type": "quantitative", "format": ",.0f"},
          {"field": "Avg_views", "type": "quantitative", "title" : "Average Views Per Video", "format": ",.0f"},
          {"field": "Avg_likes", "type": "quantitative", "title" : "Average Likes Per Video", "format": ",.0f"}
      ] }
    },
      

    {"mark": {"type": "text", "align": "left", "dx": 8, "dy": 0, "fontSize": 12},
              "encoding": {
              "x": {"field": "Avg_views", "type": "quantitative", "scale": {"type" : "log", "domain": [100, 100000000]}, "axis": {"titleFontSize": 14}},
              "y": {"field": "Avg_likes", "type": "quantitative", "scale": {"type" : "log", "domain": [1, 10000000]}, "axis": {"titleFontSize": 14}},
              "text": {"field": "Name"},
              "opacity": {
                "condition": {
                  "test": "datum.Subscribers > 100000000",
                  "value": 1
                },
                "value": 0
              }
          }
      },
      
    {"mark": {"type": "text", "align": "left", "dx": 8, "dy": 0, "fontSize": 12},
              "encoding": {
              "x": {"field": "Avg_views", "type": "quantitative", "scale": {"type" : "log", "domain": [100, 100000000]}},
              "y": {"field": "Avg_likes", "type": "quantitative", "scale": {"type" : "log", "domain": [1, 10000000]}},
              "text": {"value" : "TEDx has the lowest Average Views and Likes;because they posted 15,900 Videos"},
              "opacity": {
                "condition": {
                  "test": "datum.Name == 'TEDx Talks'",
                  "value": 1
                },
                "value": 0
              }
          }
      },

      {
      "data": {
        "sequence": {
          "start": 100,
          "stop": 100000000,
          "step": 1000,
          "as": "x"
        }
      },
      "transform": [
        {"calculate": "datum.x/25", "as": "y"} 
      ],
      "mark": {"type": "line", "color": "red", "strokeWidth": 2},
      "encoding": {
        "x": {"field": "x", "type": "quantitative", "scale": {"type" : "log", "domain": [100, 100000000]}},
        "y": {"field": "y", "type": "quantitative", "scale" : {"type" : "log", "domain": [1, 10000000]}}
      }
    }
      
      
    ]
  ,
  "config": {
    "view": {"stroke": null}
  }
}
